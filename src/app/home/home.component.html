
<!--div>
  <button mat-fab *ngIf="listening$ | async; else mic" (click)="stop()">
    <mat-icon class="soundwave">mic</mat-icon>
  </button>
  <ng-template #mic>
    <button mat-fab (click)="start()">
      <mat-icon>mic</mat-icon>
    </button>
  </ng-template>
  <button class="btn btn-primary" (click)="startSpeech()">Speech</button>
</div>
<section *ngIf="transcript$ | async">
  <mat-card class="notification mat-elevation-z4">{{transcript$ | async}}</mat-card>
</section>
<section>
  <mat-form-field class="speech-result-width">
    <textarea matInput [value]="totalTranscript || ''" placeholder="Speech Input Result" rows="15" disabled="true"></textarea>
  </mat-form-field>
</section-->
<app-header></app-header>
<div #screen *ngIf="!switchTemp; else showPhoto">
  <div *ngIf="user$ | async as user" class="main container form-group">
    <button
      *ngIf="emailConfirmed && creator"
      (click)="gotTo(true)"
      class="btn btn-primary btn-sm form-control"
    >
      Models 3D
    </button>
  </div>

  <div class="main bg-dark row">
    <div class="mb-3 col container align-center">
      <div
        class="btn-group col-12 mt-2"
        role="group"
        aria-label="Basic radio toggle button group"
      >
        <input
          type="radio"
          (click)="showmyCodeDiv(true, 'explore')"
          data-bs-toggle="modal"
          data-bs-target="#exampleModal"
          class="btn-check"
          name="btnradio"
          id="btnradio1"
          autocomplete="off"
          checked
        />
        <label class="btn btn-outline-light" for="btnradio1">Explorar</label>

        <input
          type="radio"
          (click)="showmyCodeDiv(false, 'foto')"
          class="btn-check"
          name="btnradio"
          id="btnradio2"
          autocomplete="off"
        />
        <label class="btn btn-outline-primary" for="btnradio2">Buscar</label>


        <!--input
          type="radio"
          (click)="showmyCodeDiv(false, 'tarjeta')"
          class="btn-check"
          name="btnradio"
          id="btnradio3"
          autocomplete="off"
        />
        <label class="btn btn-outline-primary" for="btnradio3">Tarjeta</label>

        <input
          type="radio"
          (click)="showmyCodeDiv(false, 'avatar')"
          class="btn-check"
          name="btnradio"
          id="btnradio4"
          autocomplete="off"
        />
        <label class="btn btn-outline-primary" for="btnradio4">Avatar</label-->
      </div>
      <!--div class="container">
          
        <button (click)="showmyCodeDiv(false)" class="btn btn-outline-primary col-6">Tríptico 3d</button>
          <button class="btn btn-primary col-4">Foto 3d</button>
          <button class="btn btn-primary col-4">Tarjeta 3d</button>
          <button class="btn btn-primary col-4">Menú 3d</button>
          
       </div-->
    </div>
  </div>

  <h1 id="error" class="text-bg-danger text-center ms-5 me-5 mt-1">{{ textError }}</h1>
  <div *ngIf="showCodeDiv; else showCodeInput" class="main row">
    <div class="container form-group">
      <!--button
        id="showingModal"
        (click)="setLugares()"
        class="btn btn-warning col-4 btn-md offset-4 text-bg-primary"
        type="button"
        data-bs-toggle="modal"
        data-bs-target="#exampleModal"
      >
        Cambiar locación
      </button-->
      <!--button
        class="btn btn-warning col-4 btn-md offset-2 text-bg-dark"
        (click)="startSpeech()"
        
      >
        Búsqueda por Voz
      </button-->
      <div class="accordion pt-2 accordion-flush" id="accordionFlushExample">
        <div class="accordion-item text-blue bg-opacity-75 col-12 bg-dark">
          <h2 class="accordion-header row text-bg-warning" id="flush-headingOne">
            <button
            id="accordionBtn"
              class="accordion-button text-bg-success bg-gradient text-white bg-transparent"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#collapseOne"
              aria-expanded="false"
              aria-controls="collapseOne"
            >
              Buscar en {{location}}
            </button>
          </h2>
          <div
            id="collapseOne"
            class="accordion-collapse collapse show"
            aria-labelledby="flush-headingOne"
            data-bs-parent="#accordionFlushExample"
          >
            <div class="accordion-body row">
              
              <div class="col-md-6 col-sm-6 col-xs-12 mb-2 row bg-light bg-opacity-50 rounded-4">
                <h3 class="bg-light rounded mb-5 text-center me-3">Buscar por lugar</h3>
                <select [ngModel]="place" (ngModelChange)="onSelectChange($event)" class="form-select text-bg-warning text-center text-white form-select-sm mb-3" name="title"  aria-label=".form-select-lg example">
                  <option *ngFor="let lugar of lugares" [ngValue]="lugar.normalizedName">{{lugar.name}}</option>
                </select>
              </div>
          
          <div class="bg-dark col-md-6 col-sm-6 col-xs-12 ms-md-3 ms-sm-4 ms-xs-0 rounded-4 row">
            <h3 class="text-bg-warning text-white text-center rounded mb-4" >Buscar por producto</h3>
            <div class="col-8 mb-2">
              <input type="text" class="form-control-sm ms-2" placeholder="playera, pantalon, mochila" [(ngModel)]="filter"/>
            </div>
            <div class="col-4 mb-2">
              <button (click)="buscarProd()" class="btn btn-sm btn-primary ">Buscar</button>
            </div>
            <div class="row">
              <p class="text-white col-2 text-end">Ej.</p>
            <span id="element" class="col-10 text-white"></span>
            </div>
            
          </div>
              <!--div class="col-6" *ngFor="let lugar of lugares">
                <button
                  (click)="onSelectBtn(lugar.name!)"
                  class="btn m-1 col-12 btn-light"
                  data-bs-toggle="collapse"
                  data-bs-target="#collapseOne"
                  aria-expanded="true"
                  aria-controls="collapseOne"
                >
                  {{ lugar.name }}
                </button>
              </div-->
            </div>
           
          </div>
          
        </div>
    
      </div>
      <!--select [ngModel]="place" (ngModelChange)="onSelectChange($event)" class="form-select form-select-md mb-3" name="title"  aria-label=".form-select-lg example">
            <option *ngFor="let lugar of lugares" [ngValue]="lugar.name">{{lugar.name}}</option>
          </select-->
          
    </div>
   
    <div
      *ngFor="let element of elements"
      class="card"
      class="mt-3 col-xs-6 col-sm-6 col-md-4 col-lg-3 mb-5"
    >
    <div id="item{{ element.id }}" class="carousel" >

      <div class="carousel-inner bg-dark">
    <div  *ngFor="let image of element.images; index as index" [ngClass]="{
      'carousel-item': true,
      'active': index==0
    }" 
    >
    <div class="card-body bg-info rounded m-2">
      <div class="container mt-2 pb-2 pt-1">
        <p class="text-success text-end">{{image.title}}</p>
        <h2 class="text-center text-info mt-3 bg-white">
          {{ image.name }} 
        </h2>
        <h4 class="text-bg-dark text-center rounded">{{element.name}}</h4>
        <button
        *ngIf="image.type =='model'"
          (click)="switchToPlace(element)"
          class="btn col-12 btn-warning"
        >
          QR
        </button>
        <button
        *ngIf="emailConfirmed"
          (click)="switchTo3D(element)"
          class="btn col-12 btn-light"
        >
          3D
        </button>
        <button (click)="showItem(element,image)" class="btn col-12 btn-primary" data-bs-toggle="modal"
        data-bs-target="#exampleModal">
          Ver más
        </button>
        <div  class="rounded m-2">
          <img *ngIf="image.type === 'image' || image.type === 'model'" src="{{ image.url }}" class="card-img-top" alt="..." />
          <video  class="d-block w-100" style="z-index: 0;"
                  id='videoplayer{{index}}' 
                  controls  *ngIf="image.type === 'video'" 
                  width="360"
                 height="240">
                <source src="{{image.url}}" type="video/mp4">
               </video>
        </div>
        
        
        <p class="text-bg-dark rounded text-center">{{image.description}}</p>
      </div>

    </div>
    <div *ngIf="element.images!.length>1">
      <button class="carousel-control-prev" style="max-height: 60px;margin-top: 150px;background-color: black;" type="button" [attr.data-bs-target]="'#item'+element.id" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" style="height: 60px;margin-top: 150px;background-color: black;" type="button" [attr.data-bs-target]="'#item'+element.id" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </div>
  </div>
</div>
      <!--div class="card-body bg-info rounded m-2">
        <div class="container mt-2 pb-2 pt-1">
          <h2 class="text-center text-info mt-3 bg-white">
            {{ element.name }}
          </h2>

          <button
            (click)="switchToPlace(element)"
            class="btn col-6 btn-warning"
          >
            QR
          </button>
          <button
          *ngIf="emailConfirmed"
            (click)="switchTo3D(element)"
            class="btn col-6 btn-light"
          >
            3D
          </button>
          <button (click)="showItem(element)" class="btn col-6 btn-primary" data-bs-toggle="modal"
          data-bs-target="#exampleModal">
            Galeria
          </button>
          <div class="rounded m-2">
            <img src="{{ element.url }}" class="card-img-top" alt="..." />
          </div>
          
          <p class="text-bg-dark rounded text-center">{{element.description}}</p>
        </div>

      </div-->
      
    </div>
  </div>
  <ng-template #showCodeInput>
    <div class="container center form">
      <h1 class="text-center text-warning">Que deseas buscar</h1>
      <select [ngModel]="place" (ngModelChange)="onItemSelectChange($event)" class="form-select form-select-md mb-3" name="title"  aria-label=".form-select-lg example">
            <option *ngFor="let folder of folders" [ngValue]="folder.description">{{folder.name}}</option>
          </select>
      <h4 class="text-center text-warning">Inserta tu codigo</h4>
      <input
        id="codeForElement"
        class="form-control form-text m-3"
        type="text"
        [(ngModel)]="elementNumber"
      />
      <button
        class="form-control btn btn-outline-primary m-3"
        (click)="getARElement()"
      >
        Buscar
      </button>
    </div>
  </ng-template>

</div>
<ng-template #showPhoto>
  <app-afelement *ngIf="afelement" (returnBtn)="gotTo($event)" [item]="itemAR"></app-afelement>
  <app-arelement *ngIf="arelement" (returnBtn)="gotTo($event)" [itemAR]="itemAR" [modelos]="models"></app-arelement>
</ng-template>

<app-modal
  [uploadimage]="uploadimage"
  [caller]="caller"
  [item]="currentItem"
  [search]="search"
  [isform]="isForm"
  [codes]="codes"
  [elements]="indexElements"
  [currentMarkerIndex]="currentMarkerIndex"
  (selectedValue)="changePlace($event)"
></app-modal>
